"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[164],{1470:(e,n,t)=>{t.d(n,{A:()=>v});var o=t(6540),r=t(4164),a=t(3104),s=t(6347),i=t(205),c=t(7485),l=t(1682),d=t(679);function u(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,o.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:t,default:o}})=>({value:e,label:n,attributes:t,default:o})))}(t);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m({value:e,tabValues:n}){return n.some((n=>n.value===e))}function f({queryString:e=!1,groupId:n}){const t=(0,s.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(r),(0,o.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})}),[r,t])]}function p(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,a=h(e),[s,c]=(0,o.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:a}))),[l,u]=f({queryString:t,groupId:r}),[p,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,d.Dv)(n);return[t,(0,o.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:r}),x=(()=>{const e=l??p;return m({value:e,tabValues:a})?e:null})();(0,i.A)((()=>{x&&c(x)}),[x]);return{selectedValue:s,selectValue:(0,o.useCallback)((e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),g(e)}),[u,g,a]),tabValues:a}}var g=t(2303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(4848);function _({className:e,block:n,selectedValue:t,selectValue:o,tabValues:s}){const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),l=e=>{const n=e.currentTarget,r=i.indexOf(n),a=s[r].value;a!==t&&(c(n),o(a))},d=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:o})=>(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:l,...o,className:(0,r.A)("tabs__item",x.tabItem,o?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function y({lazy:e,children:n,selectedValue:t}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find((e=>e.props.value===t));return e?(0,o.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function j(e){const n=p(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",x.tabList),children:[(0,b.jsx)(_,{...n,...e}),(0,b.jsx)(y,{...n,...e})]})}function v(e){const n=(0,g.A)();return(0,b.jsx)(j,{...e,children:u(e.children)},String(n))}},4290:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"developer/general_concepts/document","title":"Document","description":"The Document is the entry point of any Python script for Tangerine. It reflects the current state of Tangerine: the current shot data (animations, loaded rigs, cameras...), the selection, the undo/redo history, and it can synchronize all the windows and widgets from user editions. Its generic name is voluntarily basic so everyone can understand it\'s the root Python object of everything in Tangerine.","source":"@site/docs/developer/general_concepts/document.md","sourceDirName":"developer/general_concepts","slug":"/developer/general_concepts/document","permalink":"/tangerine-docs/developer/general_concepts/document","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"API Structure","permalink":"/tangerine-docs/developer/general_concepts/api_structure"},"next":{"title":"Nodes","permalink":"/tangerine-docs/developer/general_concepts/nodes"}}');var r=t(4848),a=t(8453);t(1470),t(9365);const s={sidebar_position:2},i="Document",c={},l=[{value:"Main Document Attributes",id:"main-document-attributes",level:2},{value:"Main Document Functions",id:"main-document-functions",level:2},{value:"Document functions related to edition",id:"document-functions-related-to-edition",level:3},{value:"Document functions related to shot files (*.shot)",id:"document-functions-related-to-shot-files-shot",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"document",children:"Document"})}),"\n",(0,r.jsx)(n.p,{children:"The Document is the entry point of any Python script for Tangerine. It reflects the current state of Tangerine: the current shot data (animations, loaded rigs, cameras...), the selection, the undo/redo history, and it can synchronize all the windows and widgets from user editions. Its generic name is voluntarily basic so everyone can understand it's the root Python object of everything in Tangerine."}),"\n",(0,r.jsx)(n.p,{children:"Note that the Document is different from the Qt application object, and it's different from the Qt main window object.\nHere is how you can get those in your scripts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from app.get_tang_app import get_tang_app\nfrom tang_gui.get_tang_window import get_tang_window\nfrom tang_core.document.get_document import get_document\n\napp = get_tang_app()  # the Qt application, rarely used in your scripts\nwindow = get_tang_window()  # the Qt main window (in GUI mode), use it to add custom menus/widgets\ndoc = get_document()  # the Tangerine API entry point, use it in ALL your scripts\n"})}),"\n",(0,r.jsx)(n.p,{children:"Of course, you should not instanciate the Document class, there is only exactly one Document instance living in Tangerine."}),"\n",(0,r.jsx)(n.p,{children:"Finally, know that all the multithreading stuff in Tangerine is handled by the Document too, especially stopping and relaunching its background engine to compute the rigs at each frame. Of course this is totally transparent to the developer, but in case you need a new export file format, you still need to ensure everything is computed before actually exporting any data, here is how:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_core.document.get_document import get_document\n\ndoc = get_document()\ndoc.synch_compute_all_frames()  # ensure all rigs are computed at all frames\n\n# ... export data in your format\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This is automatically called when exporting to alembic or USD formats, and when playblasting, so call ",(0,r.jsx)(n.code,{children:"synch_compute_all_frames()"})," only if you create a custom export function."]}),"\n",(0,r.jsx)(n.p,{children:"The following sections give the main Document attributes and functions.\nThe Tangerine API Reference lists all of them in a more exhaustively."}),"\n",(0,r.jsx)(n.h2,{id:"main-document-attributes",children:"Main Document Attributes"}),"\n",(0,r.jsx)(n.p,{children:"Here are the main attributes of the Document object that you can use in your scripts, for both read and write:"}),"\n",(0,r.jsx)(n.p,{children:"Attributes stored in the shot file:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"start_frame"})," and ",(0,r.jsx)(n.code,{children:"end_frame"}),": define the frame bounds of the current shot"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"fps"}),": usually 24 or 25, that's the number of frames per second the playback of Tangerine will give you"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sound_path"})," and ",(0,r.jsx)(n.code,{children:"sound_offset"}),": each shot can have a sound track, it's useful to synchronize the animation with actor voices and sound effetcs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"library_server_path"})," and ",(0,r.jsx)(n.code,{children:"picker_server_path"}),": paths you can setup for each production, this is where the library (preset poses and anim clips) and the pickers, all shared among animators, are stored."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Attributes ",(0,r.jsx)(n.strong,{children:"not"})," stored in the shot file:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"saved_file_path"}),": used for both shot and asset files, it's empty until a file has been saved"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"current_frame"}),": that's the current frame for all viewports, you can see and edit it in the Timeline and the Curve Editor"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"range_start_frame"}),"and ",(0,r.jsx)(n.code,{children:"range_end_frame"}),": see right above the Timeline, that's the range of playback the animator often need to focus on."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"camera"}),": the camera set in the active viewport"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example script:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_core.document.get_document import get_document\n\ndoc = get_document()\ndoc.fps = 25\ndoc.start_frame = 1\ndoc.end_frame = 40\ndoc.range_start_frame = 10\ndoc.range_end_frame = 30\ndoc.current_frame = 20\n"})}),"\n",(0,r.jsx)(n.h2,{id:"main-document-functions",children:"Main Document Functions"}),"\n",(0,r.jsx)(n.h3,{id:"document-functions-related-to-edition",children:"Document functions related to edition"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"root()"})," returns to root node that hold all the scene graph in Tangerine (see the Nodes section for more details)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"modify()"})," returns a Modifier (see the Modifiers section for more details), it ",(0,r.jsx)(n.strong,{children:"must"}),' be used in the pythonic way "with".']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"node_selection()"})," returns a list of all selected controller nodes, as seen in the Channels view, the Timeline and the Curve Editor"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"We already used modify() before, see in the Hello Tangerine page. And we used root() too when we loaded an alembic file because we needed a parent node to attach the loaded hierarchy to. Here is an example script where we use modify() again but with the node selection this time:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'with document.modify("main functions example") as modifier:\n\tfor node in document.node_selection():\n\t\tmodifier.set_plug_value(node.tx, 2.0)\n'})}),"\n",(0,r.jsx)(n.p,{children:'To test this script: add a few dummies in Tangerine, by default the Dummies windows is tabbed at the bottom right, with the Shot Constraints and Shot Clusters windows. Simply right click in the Dummies window and select "Create > cube" for example, add many dummies and press F to frame the camera viewport so you can see them. Press W for the Translation Tool and move them around. Then, copy/paste the script in the Command Line window and press Enter. See how the Translate X of each dummy selected has been set to 2.0 in the Channels view.'}),"\n",(0,r.jsx)(n.h3,{id:"document-functions-related-to-shot-files-shot",children:"Document functions related to shot files (*.shot)"}),"\n",(0,r.jsxs)(n.p,{children:["To ",(0,r.jsx)(n.strong,{children:"save"})," a shot file, in both GUI mode or batch mode:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_core.document.shot import Shot\nfrom tang_core.document.get_document import get_document\n\nShot.export_shot_file(file_path, get_document())\n"})}),"\n",(0,r.jsxs)(n.p,{children:["To ",(0,r.jsx)(n.strong,{children:"read"})," a shot file, it's different in GUI mode and batch mode:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"in GUI mode:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_gui.get_tang_window import get_tang_window\n\nget_tang_window().import_shot_files([file_path])\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"in batch mode (no GUI):"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_core.document.shot import Shot\nfrom tang_core.document.get_document import get_document\n\nShot.import_shot_files([file_path], get_document())\n"})}),"\n",(0,r.jsxs)(n.p,{children:["To ",(0,r.jsx)(n.strong,{children:"create"})," a new shot, it's also different in GUI mode and batch mode:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"in GUI mode:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_gui.get_tang_window import get_tang_window\n\nget_tang_window().do_new_document(start_frame=1, end_frame=100, fps=24)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"in batch mode (no GUI):"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from tang_core.document.get_document import get_document\n\nget_document().init_new(start_frame=1, end_frame=100, fps=24)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["We have seen in this section what the Document is, and what are its main attributes and functions. The full documentation of the Document class is given in the Tangerine API Reference.\nWe have seen briefly how a modifier can alter the values of the shot by modifying node values. The next sections give more details about ",(0,r.jsx)(n.strong,{children:"Nodes"})," and ",(0,r.jsx)(n.strong,{children:"Modifiers"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>i});var o=t(6540);const r={},a=o.createContext(r);function s(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(a.Provider,{value:n},e.children)}},9365:(e,n,t)=>{t.d(n,{A:()=>s});t(6540);var o=t(4164);const r={tabItem:"tabItem_Ymn6"};var a=t(4848);function s({children:e,hidden:n,className:t}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,o.A)(r.tabItem,t),hidden:n,children:e})}}}]);